!function(){var e,t={63106:function(e,t){"use strict";t.__esModule=!0,t.createUuid=void 0;t.createUuid=function(){var e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?n:3&n|8).toString(16)}))}},50067:function(e,t,n){"use strict";t.__esModule=!0,t.Notifications=void 0;var o=n(53658),r=n(17760),a=function(e){var t=e.children;return(0,o.createVNode)(1,"div","Notifications",t,0)};t.Notifications=a;a.Item=function(e){var t=e.rightSlot,n=e.children;return(0,o.createComponentVNode)(2,r.Flex,{align:"center",className:"Notification",children:[(0,o.createComponentVNode)(2,r.Flex.Item,{className:"Notification__content",grow:1,children:n}),t&&(0,o.createComponentVNode)(2,r.Flex.Item,{className:"Notification__rightSlot",children:t})]})}},20978:function(e,t,n){"use strict";t.__esModule=!0,t.Panel=void 0;var o=n(53658),r=n(17760),a=n(753),i=n(58315),c=n(34448),s=n(81097),l=n(50067),u=n(13459),d=n(93779);t.Panel=function(e,t){if(Byond.IS_LTE_IE10)return(0,o.createComponentVNode)(2,g);var n=(0,i.useAudio)(t),p=(0,u.useSettings)(t),h=(0,d.useSpellCheckerSettings)(t),m=(0,s.useGame)(t);return(0,o.createComponentVNode)(2,a.Pane,{theme:p.theme,children:(0,o.createComponentVNode)(2,r.Stack,{fill:!0,vertical:!0,children:[(0,o.createComponentVNode)(2,r.Stack.Item,{children:(0,o.createComponentVNode)(2,r.Section,{fitted:!0,children:(0,o.createComponentVNode)(2,r.Stack,{mr:1,align:"center",children:[(0,o.createComponentVNode)(2,r.Stack.Item,{grow:!0,overflowX:"auto",children:(0,o.createComponentVNode)(2,c.ChatTabs)}),(0,o.createComponentVNode)(2,r.Stack.Item,{children:(0,o.createComponentVNode)(2,r.Button,{color:h.enabled?"yellow":"grey",selected:h.visible,icon:"spell-check",tooltip:"Yandex Spell Checker",tooltipPosition:"bottom-start",onClick:function(){return h.toggle()}})}),(0,o.createComponentVNode)(2,r.Stack.Item,{children:(0,o.createComponentVNode)(2,r.Button,{color:"grey",selected:n.visible,icon:"music",tooltip:"Music player",tooltipPosition:"bottom-start",onClick:function(){return n.toggle()}})}),(0,o.createComponentVNode)(2,r.Stack.Item,{children:(0,o.createComponentVNode)(2,r.Button,{icon:p.visible?"times":"cog",selected:p.visible,tooltip:p.visible?"Close settings":"Open settings",tooltipPosition:"bottom-start",onClick:function(){return p.toggle()}})})]})})}),n.visible&&(0,o.createComponentVNode)(2,r.Stack.Item,{children:(0,o.createComponentVNode)(2,r.Section,{children:(0,o.createComponentVNode)(2,i.NowPlayingWidget)})}),p.visible&&(0,o.createComponentVNode)(2,r.Stack.Item,{children:(0,o.createComponentVNode)(2,u.SettingsPanel)}),h.visible&&(0,o.createComponentVNode)(2,r.Stack.Item,{children:(0,o.createComponentVNode)(2,d.SpellCheckerSettings)}),(0,o.createComponentVNode)(2,r.Stack.Item,{grow:!0,children:(0,o.createComponentVNode)(2,r.Section,{fill:!0,fitted:!0,position:"relative",children:[(0,o.createComponentVNode)(2,a.Pane.Content,{id:"chatContainer",scrollable:!0,children:(0,o.createComponentVNode)(2,c.ChatPanel,{lineHeight:p.lineHeight})}),(0,o.createComponentVNode)(2,l.Notifications,{children:m.roundRestartedAt&&(0,o.createComponentVNode)(2,l.Notifications.Item,{children:"The connection has been closed because the server is restarting. Please wait while you automatically reconnect."})}),(0,o.createVNode)(1,"div",null,null,1,{id:"imageContainer"})]})})]})})};var g=function(e,t){var n=(0,u.useSettings)(t);return(0,o.createComponentVNode)(2,a.Pane,{theme:n.theme,children:(0,o.createComponentVNode)(2,a.Pane.Content,{scrollable:!0,children:[(0,o.createComponentVNode)(2,r.Button,{style:{position:"fixed",top:"1em",right:"2em","z-index":1e3},selected:n.visible,onClick:function(){return n.toggle()},children:"Settings"}),n.visible&&(0,o.createComponentVNode)(2,u.SettingsPanel)||(0,o.createComponentVNode)(2,c.ChatPanel,{lineHeight:n.lineHeight})]})})}},76351:function(e,t,n){"use strict";t.__esModule=!0,t.NowPlayingWidget=void 0;var o=n(53658),r=n(18098),a=n(53703),i=n(17760),c=n(13459),s=n(1656);t.NowPlayingWidget=function(e,t){var n,l=(0,a.useSelector)(t,s.selectAudio),u=(0,a.useDispatch)(t),d=(0,c.useSettings)(t),g=null==(n=l.meta)?void 0:n.title;return(0,o.createComponentVNode)(2,i.Flex,{align:"center",children:[l.playing&&(0,o.createFragment)([(0,o.createComponentVNode)(2,i.Flex.Item,{shrink:0,mx:.5,color:"label",children:"Now playing:"}),(0,o.createComponentVNode)(2,i.Flex.Item,{mx:.5,grow:1,style:{"white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis"},children:g||"Unknown Track"})],4)||(0,o.createComponentVNode)(2,i.Flex.Item,{grow:1,color:"label",children:"Nothing to play."}),l.playing&&(0,o.createComponentVNode)(2,i.Flex.Item,{mx:.5,fontSize:"0.9em",children:(0,o.createComponentVNode)(2,i.Button,{tooltip:"Stop",icon:"stop",onClick:function(){return u({type:"audio/stopMusic"})}})}),(0,o.createComponentVNode)(2,i.Flex.Item,{mx:.5,fontSize:"0.9em",children:(0,o.createComponentVNode)(2,i.Knob,{minValue:0,maxValue:1,value:d.adminMusicVolume,step:.0025,stepPixelSize:1,format:function(e){return(0,r.toFixed)(100*e)+"%"},onDrag:function(e,t){return d.update({adminMusicVolume:t})}})})]})}},6280:function(e,t,n){"use strict";t.__esModule=!0,t.useAudio=void 0;var o=n(53703),r=n(1656);t.useAudio=function(e){var t=(0,o.useSelector)(e,r.selectAudio),n=(0,o.useDispatch)(e);return Object.assign({},t,{toggle:function(){return n({type:"audio/toggle"})}})}},58315:function(e,t,n){"use strict";t.__esModule=!0,t.useAudio=t.audioReducer=t.audioMiddleware=t.NowPlayingWidget=void 0;var o=n(6280);t.useAudio=o.useAudio;var r=n(38159);t.audioMiddleware=r.audioMiddleware;var a=n(76351);t.NowPlayingWidget=a.NowPlayingWidget;var i=n(41409);t.audioReducer=i.audioReducer},38159:function(e,t,n){"use strict";t.__esModule=!0,t.audioMiddleware=void 0;var o=n(57397),r=["url"];t.audioMiddleware=function(e){var t=new o.AudioPlayer;return t.onPlay((function(){e.dispatch({type:"audio/playing"})})),t.onStop((function(){e.dispatch({type:"audio/stopped"})})),function(e){return function(n){var o=n.type,a=n.payload;if("audio/playMusic"===o){var i=a.url,c=function(e,t){if(null==e)return{};var n,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(a,r);return t.play(i,c),e(n)}if("audio/stopMusic"===o)return t.stop(),e(n);if("settings/update"===o||"settings/load"===o){var s=null==a?void 0:a.adminMusicVolume;return"number"==typeof s&&t.setVolume(s),e(n)}return e(n)}}}},57397:function(e,t,n){"use strict";function o(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return r(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0;return function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}t.__esModule=!0,t.AudioPlayer=void 0;var a=(0,n(52974).createLogger)("AudioPlayer"),i=function(){function e(){var e=this;Byond.IS_LTE_IE9||(this.node=document.createElement("audio"),this.node.style.setProperty("display","none"),document.body.appendChild(this.node),this.playing=!1,this.volume=1,this.options={},this.onPlaySubscribers=[],this.onStopSubscribers=[],this.node.addEventListener("canplaythrough",(function(){a.log("canplaythrough"),e.playing=!0,e.node.playbackRate=e.options.pitch||1,e.node.currentTime=e.options.start||0,e.node.volume=e.volume,e.node.play();for(var t,n=o(e.onPlaySubscribers);!(t=n()).done;){(0,t.value)()}})),this.node.addEventListener("ended",(function(){a.log("ended"),e.stop()})),this.node.addEventListener("error",(function(t){e.playing&&(a.log("playback error",t.error),e.stop())})),this.playbackInterval=setInterval((function(){e.playing&&(e.options.end>0&&e.node.currentTime>=e.options.end&&e.stop())}),1e3))}var t=e.prototype;return t.destroy=function(){this.node&&(this.node.stop(),document.removeChild(this.node),clearInterval(this.playbackInterval))},t.play=function(e,t){void 0===t&&(t={}),this.node&&(a.log("playing",e,t),this.options=t,this.node.src=e)},t.stop=function(){if(this.node){if(this.playing)for(var e,t=o(this.onStopSubscribers);!(e=t()).done;)(0,e.value)();a.log("stopping"),this.playing=!1,this.node.src=""}},t.setVolume=function(e){this.node&&(this.volume=e,this.node.volume=e)},t.onPlay=function(e){this.node&&this.onPlaySubscribers.push(e)},t.onStop=function(e){this.node&&this.onStopSubscribers.push(e)},e}();t.AudioPlayer=i},41409:function(e,t){"use strict";t.__esModule=!0,t.audioReducer=void 0;var n={visible:!1,playing:!1,track:null};t.audioReducer=function(e,t){void 0===e&&(e=n);var o=t.type,r=t.payload;return"audio/playing"===o?Object.assign({},e,{visible:!0,playing:!0}):"audio/stopped"===o?Object.assign({},e,{visible:!1,playing:!1}):"audio/playMusic"===o?Object.assign({},e,{meta:r}):"audio/stopMusic"===o?Object.assign({},e,{visible:!1,playing:!1,meta:null}):"audio/toggle"===o?Object.assign({},e,{visible:!e.visible}):e}},1656:function(e,t){"use strict";t.__esModule=!0,t.selectAudio=void 0;t.selectAudio=function(e){return e.audio}},56812:function(e,t,n){"use strict";t.__esModule=!0,t.ChatPageSettings=void 0;var o=n(53658),r=n(53703),a=n(17760),i=n(49474),c=n(51515),s=n(83790);t.ChatPageSettings=function(e,t){var n=(0,r.useSelector)(t,s.selectCurrentChatPage),l=(0,r.useDispatch)(t);return(0,o.createComponentVNode)(2,a.Section,{children:[(0,o.createComponentVNode)(2,a.Stack,{align:"center",children:[(0,o.createComponentVNode)(2,a.Stack.Item,{grow:1,children:(0,o.createComponentVNode)(2,a.Input,{fluid:!0,value:n.name,onChange:function(e,t){return l((0,i.updateChatPage)({pageId:n.id,name:t}))}})}),(0,o.createComponentVNode)(2,a.Stack.Item,{children:(0,o.createComponentVNode)(2,a.Button,{icon:"times",color:"red",onClick:function(){return l((0,i.removeChatPage)({pageId:n.id}))},children:"Remove"})})]}),(0,o.createComponentVNode)(2,a.Divider),(0,o.createComponentVNode)(2,a.Section,{title:"Messages to display",level:2,children:[c.MESSAGE_TYPES.filter((function(e){return!e.important&&!e.admin})).map((function(e){return(0,o.createComponentVNode)(2,a.Button.Checkbox,{checked:n.acceptedTypes[e.type],onClick:function(){return l((0,i.toggleAcceptedType)({pageId:n.id,type:e.type}))},children:e.name},e.type)})),(0,o.createComponentVNode)(2,a.Collapsible,{mt:1,color:"transparent",title:"Admin stuff",children:c.MESSAGE_TYPES.filter((function(e){return!e.important&&e.admin})).map((function(e){return(0,o.createComponentVNode)(2,a.Button.Checkbox,{checked:n.acceptedTypes[e.type],onClick:function(){return l((0,i.toggleAcceptedType)({pageId:n.id,type:e.type}))},children:e.name},e.type)}))})]})]})}},17094:function(e,t,n){"use strict";t.__esModule=!0,t.ChatPanel=void 0;var o=n(53658),r=n(63184),a=n(17760),i=n(42538);function c(e,t){return c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},c(e,t)}var s=function(e){var t,n;function s(){var t;return(t=e.call(this)||this).ref=(0,o.createRef)(),t.state={scrollTracking:!0},t.handleScrollTrackingChange=function(e){return t.setState({scrollTracking:e})},t}n=e,(t=s).prototype=Object.create(n.prototype),t.prototype.constructor=t,c(t,n);var l=s.prototype;return l.componentDidMount=function(){i.chatRenderer.mount(this.ref.current),i.chatRenderer.events.on("scrollTrackingChanged",this.handleScrollTrackingChange),this.componentDidUpdate()},l.componentWillUnmount=function(){i.chatRenderer.events.off("scrollTrackingChanged",this.handleScrollTrackingChange)},l.componentDidUpdate=function(e){requestAnimationFrame((function(){i.chatRenderer.ensureScrollTracking()})),(!e||(0,r.shallowDiffers)(this.props,e))&&i.chatRenderer.assignStyle({width:"100%","white-space":"pre-wrap","font-size":this.props.fontSize,"line-height":this.props.lineHeight})},l.render=function(){var e=this.state.scrollTracking;return(0,o.createFragment)([(0,o.createVNode)(1,"div","Chat",null,1,null,null,this.ref),!e&&(0,o.createComponentVNode)(2,a.Button,{className:"Chat__scrollButton",icon:"arrow-down",onClick:function(){return i.chatRenderer.scrollToBottom()},children:"Scroll to bottom"})],0)},s}(o.Component);t.ChatPanel=s},28796:function(e,t,n){"use strict";t.__esModule=!0,t.ChatTabs=void 0;var o=n(53658),r=n(53703),a=n(17760),i=n(49474),c=n(83790),s=n(66068),l=function(e){var t=e.value;return(0,o.createComponentVNode)(2,a.Box,{style:{"font-size":"0.7em","border-radius":"0.25em",width:"1.7em","line-height":"1.55em","background-color":"crimson",color:"#fff"},children:Math.min(t,99)})};t.ChatTabs=function(e,t){var n=(0,r.useSelector)(t,c.selectChatPages),u=(0,r.useSelector)(t,c.selectCurrentChatPage),d=(0,r.useDispatch)(t);return(0,o.createComponentVNode)(2,a.Flex,{align:"center",children:[(0,o.createComponentVNode)(2,a.Flex.Item,{children:(0,o.createComponentVNode)(2,a.Tabs,{textAlign:"center",children:n.map((function(e){return(0,o.createComponentVNode)(2,a.Tabs.Tab,{selected:e===u,rightSlot:e.unreadCount>0&&(0,o.createComponentVNode)(2,l,{value:e.unreadCount}),onClick:function(){return d((0,i.changeChatPage)({pageId:e.id}))},children:e.name},e.id)}))})}),(0,o.createComponentVNode)(2,a.Flex.Item,{ml:1,children:(0,o.createComponentVNode)(2,a.Button,{color:"transparent",icon:"plus",onClick:function(){d((0,i.addChatPage)()),d((0,s.openChatSettings)())}})})]})}},49474:function(e,t,n){"use strict";t.__esModule=!0,t.updateMessageCount=t.updateChatPage=t.toggleAcceptedType=t.saveSettingsToDisk=t.saveChatToDisk=t.resetSettings=t.removeChatPage=t.rebuildChat=t.loadSettingsFromDisk=t.loadChat=t.changeScrollTracking=t.changeChatPage=t.addChatPage=void 0;var o=n(53703),r=n(58746),a=(0,o.createAction)("chat/load");t.loadChat=a;var i=(0,o.createAction)("chat/rebuild");t.rebuildChat=i;var c=(0,o.createAction)("chat/updateMessageCount");t.updateMessageCount=c;var s=(0,o.createAction)("chat/addPage",(function(){return{payload:(0,r.createPage)()}}));t.addChatPage=s;var l=(0,o.createAction)("chat/changePage");t.changeChatPage=l;var u=(0,o.createAction)("chat/updatePage");t.updateChatPage=u;var d=(0,o.createAction)("chat/toggleAcceptedType");t.toggleAcceptedType=d;var g=(0,o.createAction)("chat/removePage");t.removeChatPage=g;var p=(0,o.createAction)("chat/changeScrollTracking");t.changeScrollTracking=p;var h=(0,o.createAction)("chat/saveToDisk");t.saveChatToDisk=h;var m=(0,o.createAction)("chat/saveSettingsToDisk");t.saveSettingsToDisk=m;var f=(0,o.createAction)("chat/loadSettingsFromDisk");t.loadSettingsFromDisk=f;var v=(0,o.createAction)("chat/resetSettings");t.resetSettings=v},51515:function(e,t){"use strict";t.__esModule=!0,t.MESSAGE_TYPE_WARNING=t.MESSAGE_TYPE_UNKNOWN=t.MESSAGE_TYPE_UIDEBUG=t.MESSAGE_TYPE_SYSTEM=t.MESSAGE_TYPE_RADIO=t.MESSAGE_TYPE_PRAY=t.MESSAGE_TYPE_OOC=t.MESSAGE_TYPE_MODCHAT=t.MESSAGE_TYPE_LOOC=t.MESSAGE_TYPE_LOCALCHAT=t.MESSAGE_TYPE_INTERNAL=t.MESSAGE_TYPE_INFO=t.MESSAGE_TYPE_EVENTCHAT=t.MESSAGE_TYPE_DOOC=t.MESSAGE_TYPE_DEBUG=t.MESSAGE_TYPE_DEADCHAT=t.MESSAGE_TYPE_COMBAT=t.MESSAGE_TYPE_ATTACKLOG=t.MESSAGE_TYPE_AOOC=t.MESSAGE_TYPE_ADMINPM=t.MESSAGE_TYPE_ADMINLOG=t.MESSAGE_TYPE_ADMINCHAT=t.MESSAGE_TYPES=t.MESSAGE_SAVE_INTERVAL=t.MESSAGE_PRUNE_INTERVAL=t.MAX_VISIBLE_MESSAGES=t.MAX_PERSISTED_MESSAGES=t.IMAGE_RETRY_MESSAGE_AGE=t.IMAGE_RETRY_LIMIT=t.IMAGE_RETRY_DELAY=t.COMBINE_MAX_TIME_WINDOW=t.COMBINE_MAX_MESSAGES=void 0;t.MAX_VISIBLE_MESSAGES=2500;t.MAX_PERSISTED_MESSAGES=1e3;t.MESSAGE_SAVE_INTERVAL=1e4;t.MESSAGE_PRUNE_INTERVAL=6e4;t.COMBINE_MAX_MESSAGES=5;t.COMBINE_MAX_TIME_WINDOW=5e3;t.IMAGE_RETRY_DELAY=250;t.IMAGE_RETRY_LIMIT=10;t.IMAGE_RETRY_MESSAGE_AGE=6e4;var n="unknown";t.MESSAGE_TYPE_UNKNOWN=n;t.MESSAGE_TYPE_INTERNAL="internal";var o="system";t.MESSAGE_TYPE_SYSTEM=o;var r="localchat";t.MESSAGE_TYPE_LOCALCHAT=r;var a="radio";t.MESSAGE_TYPE_RADIO=a;var i="info";t.MESSAGE_TYPE_INFO=i;var c="warning";t.MESSAGE_TYPE_WARNING=c;var s="deadchat";t.MESSAGE_TYPE_DEADCHAT=s;t.MESSAGE_TYPE_OOC="ooc";var l="looc";t.MESSAGE_TYPE_LOOC=l;var u="aooc";t.MESSAGE_TYPE_AOOC=u;var d="dooc";t.MESSAGE_TYPE_DOOC=d;var g="pray";t.MESSAGE_TYPE_PRAY=g;var p="adminpm";t.MESSAGE_TYPE_ADMINPM=p;var h="combat";t.MESSAGE_TYPE_COMBAT=h;var m="adminchat";t.MESSAGE_TYPE_ADMINCHAT=m;var f="modchat";t.MESSAGE_TYPE_MODCHAT=f;t.MESSAGE_TYPE_EVENTCHAT="eventchat";var v="adminlog";t.MESSAGE_TYPE_ADMINLOG=v;var S="attacklog";t.MESSAGE_TYPE_ATTACKLOG=S;var b="debug";t.MESSAGE_TYPE_DEBUG=b;var y="uidebug";t.MESSAGE_TYPE_UIDEBUG=y;var C=[{type:o,name:"System Messages",description:"Messages from your client, always enabled",selector:".boldannounce",important:!0},{type:r,name:"Local",description:"In-character local messages (say, emote, etc)",selector:".say, .emote"},{type:a,name:"Radio",description:"All departments of radio messages",selector:".alert, .minorannounce, .syndradio, .centcomradio, .aiprivradio, .comradio, .secradio, .engradio, .medradio, .sciradio, .suppradio, .servradio, .radio, .deptradio, .binarysay, .newscaster, .resonate"},{type:i,name:"Info",description:"Non-urgent messages from the game and items",selector:".notice:not(.pm), .adminnotice, .info, .sinister, .cult, .infoplain, .announce, .hear, .smallnotice, .holoparasite"},{type:c,name:"Warnings",description:"Urgent messages from the game and items",selector:".warning:not(.pm), .critical, .userdanger, .italics, .alertsyndie, .warningplain"},{type:s,name:"Deadchat",description:"All of deadchat",selector:".deadsay, .ghostalert"},{type:"ooc",name:"OOC",description:"The bluewall of global OOC messages",selector:".ooc, .oocplain, .adminooc"},{type:u,name:"AOOC",description:"Antag OOC",selector:".ooc .aooc"},{type:d,name:"Discord",description:"Messages from discord",selector:".ooc .dooc"},{type:l,name:"LOOC",description:"Local OOC",selector:".ooc .looc"},{type:g,name:"Pray",description:"A straightforward channel to speak with the God",selector:".pray"},{type:p,name:"Admin PMs",description:"Messages to/from admins (adminhelp)",selector:".pm, .adminhelp"},{type:h,name:"Combat Log",description:"Urist McTraitor has stabbed you with a knife!",selector:".danger"},{type:n,name:"Unsorted",description:"Everything we could not sort, always enabled"},{type:m,name:"Admin Chat",description:"ASAY messages",selector:".admin_channel, .adminsay",admin:!0},{type:f,name:"Mod Chat",description:"MSAY messages",selector:".mod_channel",admin:!0},{type:v,name:"Admin Log",description:"ADMIN LOG: Urist McAdmin has jumped to coordinates X, Y, Z",selector:".log_message",admin:!0},{type:S,name:"Attack Log",description:"Urist McTraitor has shot John Doe",admin:!0},{type:b,name:"Debug Log",description:"DEBUG: MC crashed or runtimed, restarting",admin:!0},{type:y,name:"Debug TGUI Log",description:"Using: /obj/machinery/autolathe [0xDEADBEEF].",admin:!0}];t.MESSAGE_TYPES=C},34448:function(e,t,n){"use strict";t.__esModule=!0,t.chatReducer=t.chatMiddleware=t.ChatTabs=t.ChatPanel=t.ChatPageSettings=void 0;var o=n(56812);t.ChatPageSettings=o.ChatPageSettings;var r=n(17094);t.ChatPanel=r.ChatPanel;var a=n(28796);t.ChatTabs=a.ChatTabs;var i=n(72838);t.chatMiddleware=i.chatMiddleware;var c=n(80497);t.chatReducer=c.chatReducer},72838:function(e,t,n){"use strict";t.__esModule=!0,t.chatMiddleware=void 0;var o,r=(o=n(38178))&&o.__esModule?o:{"default":o},a=n(86175),i=n(66068),c=n(80355),s=n(49474),l=n(51515),u=n(58746),d=n(42538),g=n(83790);function p(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return h(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return h(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0;return function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function m(e,t,n,o,r,a,i){try{var c=e[a](i),s=c.value}catch(l){return void n(l)}c.done?t(s):Promise.resolve(s).then(o,r)}function f(e){return function(){var t=this,n=arguments;return new Promise((function(o,r){var a=e.apply(t,n);function i(e){m(a,o,r,i,c,"next",e)}function c(e){m(a,o,r,i,c,"throw",e)}i(undefined)}))}}var v=["a","iframe","link","video"],S=function(){var e=f(regeneratorRuntime.mark((function t(e){var n,o,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=(0,g.selectChat)(e.getState()),o=Math.max(0,d.chatRenderer.messages.length-l.MAX_PERSISTED_MESSAGES),r=d.chatRenderer.messages.slice(o).map((function(e){return(0,u.serializeMessage)(e)})),a.storage.set("chat-state",n),a.storage.set("chat-messages",r);case 5:case"end":return t.stop()}}),t)})));return function(t){return e.apply(this,arguments)}}(),b=function(){var e=f(regeneratorRuntime.mark((function t(e){var n,o,i,c,l,g,h;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all([a.storage.get("chat-state"),a.storage.get("chat-messages")]);case 2:if(n=t.sent,o=n[0],i=n[1],!(o&&o.version<=4)){t.next=8;break}return e.dispatch((0,s.loadChat)()),t.abrupt("return");case 8:if(i){for(c=p(i);!(l=c()).done;)(g=l.value).html&&(g.html=r["default"].sanitize(g.html,{FORBID_TAGS:v}));h=[].concat(i,[(0,u.createMessage)({type:"internal/reconnected"})]),d.chatRenderer.processBatch(h,{prepend:!0})}e.dispatch((0,s.loadChat)(o));case 10:case"end":return t.stop()}}),t)})));return function(t){return e.apply(this,arguments)}}(),y=function(){var e=f(regeneratorRuntime.mark((function t(){var e,n,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.storage.get("chat-state");case 2:return t.t0=t.sent,t.next=5,a.storage.get("panel-settings");case 5:return t.t1=t.sent,t.next=8,a.storage.get("spellchecker-settings");case 8:t.t2=t.sent,e={"chat-state":t.t0,"panel-settings":t.t1,"spellchecker-settings":t.t2},n=JSON.stringify(e),o=new Blob([n],{type:"application/json"}),window.navigator.msSaveBlob(o,"tgui-settings.json");case 13:case"end":return t.stop()}}),t)})));return function(){return e.apply(this,arguments)}}();t.chatMiddleware=function(e){var t=!1,n=!1;return d.chatRenderer.events.on("batchProcessed",(function(t){n&&e.dispatch((0,s.updateMessageCount)(t))})),d.chatRenderer.events.on("scrollTrackingChanged",(function(t){e.dispatch((0,s.changeScrollTracking)(t))})),setInterval((function(){return S(e)}),l.MESSAGE_SAVE_INTERVAL),function(o){return function(r){var u=r.type,p=r.payload;if(t||(t=!0,b(e)),"chat/message"!==u){if(u===s.loadChat.type){o(r);var h=(0,g.selectCurrentChatPage)(e.getState());return d.chatRenderer.changePage(h),d.chatRenderer.onStateLoaded(),void(n=!0)}if(u!==s.changeChatPage.type&&u!==s.addChatPage.type&&u!==s.removeChatPage.type&&u!==s.toggleAcceptedType.type){if(u===s.rebuildChat.type)return d.chatRenderer.rebuildChat(),o(r);if(u!==i.updateSettings.type&&u!==i.loadSettings.type){if("roundrestart"===u)return S(e),o(r);if(u!==s.saveChatToDisk.type)if(u!==s.saveSettingsToDisk.type){if(u!==s.loadSettingsFromDisk.type)return o(r);try{!function(e){for(var t=JSON.parse(e),n=0,o=Object.keys(t);n<o.length;n++){var r=o[n];a.storage.set(r,t[r])}Byond.winset({command:"Nuke-Chat"})}(p.data)}catch(C){e.dispatch({type:"chat/message",payload:{type:l.MESSAGE_TYPE_INTERNAL,text:"Invalid JSON data: "+C}})}}else y();else d.chatRenderer.saveToDisk()}else{o(r);var m=(0,c.selectSettings)(e.getState());try{d.chatRenderer.setHighlight(m.highlightText,m.highlightColor)}catch(C){e.dispatch({type:"chat/message",payload:{type:l.MESSAGE_TYPE_INTERNAL,text:"Incorrect or unsupported regular expression: "+C}})}}}else{o(r);var f=(0,g.selectCurrentChatPage)(e.getState());d.chatRenderer.changePage(f)}}else{var v=Array.isArray(p)?p:[p];d.chatRenderer.processBatch(v)}}}}},58746:function(e,t,n){"use strict";t.__esModule=!0,t.serializeMessage=t.isSameMessage=t.createPage=t.createMessage=t.createMainPage=t.canPageAcceptType=void 0;var o=n(63106),r=n(51515);function a(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0;return function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}t.canPageAcceptType=function(e,t){return t.startsWith(r.MESSAGE_TYPE_INTERNAL)||e.acceptedTypes[t]};var c=function(e){return Object.assign({id:(0,o.createUuid)(),name:"New Tab",acceptedTypes:{},unreadCount:0,createdAt:Date.now()},e)};t.createPage=c;t.createMainPage=function(){for(var e,t={},n=a(r.MESSAGE_TYPES);!(e=n()).done;){t[e.value.type]=!0}return c({name:"Main",acceptedTypes:t})};t.createMessage=function(e){return Object.assign({createdAt:Date.now()},e)};t.serializeMessage=function(e){return{type:e.type,text:e.text,html:e.html,times:e.times,createdAt:e.createdAt}};t.isSameMessage=function(e,t){return"string"==typeof e.text&&e.text===t.text||"string"==typeof e.html&&e.html===t.html}},80497:function(e,t,n){"use strict";t.__esModule=!0,t.initialState=t.chatReducer=void 0;var o,r=n(49474),a=n(58746),i=["pageId"];function c(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0;return function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}var l=(0,a.createMainPage)(),u={version:5,currentPageId:l.id,scrollTracking:!0,pages:[l.id],pageById:(o={},o[l.id]=l,o)};t.initialState=u;t.chatReducer=function(e,t){void 0===e&&(e=u);var n,o=t.type,s=t.payload;if(o===r.loadChat.type){if((null==s?void 0:s.version)!==e.version)return e;for(var d=0,g=Object.keys(s.pageById);d<g.length;d++){var p=g[d];s.pageById[p].unreadCount=0}return Object.assign({},e,s)}if(o===r.changeScrollTracking.type){var h=s,m=Object.assign({},e,{scrollTracking:h});if(h){var f,v=e.currentPageId,S=Object.assign({},e.pageById[v],{unreadCount:0});m.pageById=Object.assign({},e.pageById,((f={})[v]=S,f))}return m}if(o===r.updateMessageCount.type){for(var b,y=s,C=e.pages.map((function(t){return e.pageById[t]})),E=e.pageById[e.currentPageId],_=Object.assign({},e.pageById),k=c(C);!(b=k()).done;){for(var A=b.value,M=0,T=0,N=Object.keys(y);T<N.length;T++){var w=N[T];(0,a.canPageAcceptType)(A,w)&&(A===E&&e.scrollTracking||A!==E&&(0,a.canPageAcceptType)(E,w)||(M+=y[w]))}M>0&&(_[A.id]=Object.assign({},A,{unreadCount:A.unreadCount+M}))}return Object.assign({},e,{pageById:_})}if(o===r.addChatPage.type)return Object.assign({},e,{currentPageId:s.id,pages:[].concat(e.pages,[s.id]),pageById:Object.assign({},e.pageById,(n={},n[s.id]=s,n))});if(o===r.changeChatPage.type){var I,P=s.pageId,x=Object.assign({},e.pageById[P],{unreadCount:0});return Object.assign({},e,{currentPageId:P,pageById:Object.assign({},e.pageById,(I={},I[P]=x,I))})}if(o===r.updateChatPage.type){var O,V=s.pageId,R=function(e,t){if(null==e)return{};var n,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(s,i),B=Object.assign({},e.pageById[V],R);return Object.assign({},e,{pageById:Object.assign({},e.pageById,(O={},O[V]=B,O))})}if(o===r.toggleAcceptedType.type){var D,G=s.pageId,L=s.type,j=Object.assign({},e.pageById[G]);return j.acceptedTypes=Object.assign({},j.acceptedTypes),j.acceptedTypes[L]=!j.acceptedTypes[L],Object.assign({},e,{pageById:Object.assign({},e.pageById,(D={},D[G]=j,D))})}if(o===r.removeChatPage.type){var Y=s.pageId,F=Object.assign({},e,{pages:[].concat(e.pages),pageById:Object.assign({},e.pageById)});return delete F.pageById[Y],F.pages=F.pages.filter((function(e){return e!==Y})),0===F.pages.length&&(F.pages.push(l.id),F.pageById[l.id]=l,F.currentPageId=l.id),F.currentPageId&&F.currentPageId!==Y||(F.currentPageId=F.pages[0]),F}return e}},42538:function(e,t,n){"use strict";t.__esModule=!0,t.chatRenderer=void 0;var o=n(24210),r=n(63184),a=n(52974),i=n(51515),c=n(58746),s=n(95879);function l(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return u(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0;return function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}var d=(0,a.createLogger)("chatRenderer"),g=function(e,t){var n=document.createElement("span");return n.className="Chat__highlight",n.setAttribute("style","background-color:"+t),n.textContent=e,n},p=function(){var e=document.createElement("div");return e.className="ChatMessage",e},h=function(){var e=document.createElement("div");return e.className="Chat__reconnected",e},m=function(e){setTimeout((function(){var t=e.target,n=parseInt(t.getAttribute("data-reload-n"),10)||0;if(n>=i.IMAGE_RETRY_LIMIT)d.error("failed to load an image after "+n+" attempts");else{var o=t.src;t.src=null,t.src=o+"#"+n,t.setAttribute("data-reload-n",n+1)}}),i.IMAGE_RETRY_DELAY)},f=function(e){var t=e.node,n=e.times;if(t&&n){var o=t.querySelector(".Chat__badge"),a=o||document.createElement("div");a.textContent=n,a.className=(0,r.classes)(["Chat__badge","Chat__badge--animate"]),requestAnimationFrame((function(){a.className="Chat__badge"})),o||t.appendChild(a)}},v=function(){function e(){var e=this;this.loaded=!1,this.rootNode=null,this.queue=[],this.messages=[],this.visibleMessages=[],this.page=null,this.events=new o.EventEmitter,this.scrollNode=null,this.scrollTracking=!0,this.handleScroll=function(t){var n=e.scrollNode,o=n.scrollHeight,r=n.scrollTop+n.offsetHeight,a=Math.abs(o-r)<24;a!==e.scrollTracking&&(e.scrollTracking=a,e.events.emit("scrollTrackingChanged",a),d.debug("tracking",e.scrollTracking))},this.ensureScrollTracking=function(){e.scrollTracking&&e.scrollToBottom()},setInterval((function(){return e.pruneMessages()}),i.MESSAGE_PRUNE_INTERVAL)}var t=e.prototype;return t.isReady=function(){return this.loaded&&this.rootNode&&this.page},t.mount=function(e){var t=this;this.rootNode?e.appendChild(this.rootNode):this.rootNode=e,this.scrollNode=function(e){for(var t=document.body,n=e;n&&n!==t;){if(n.scrollWidth<n.offsetWidth)return n;n=n.parentNode}return window}(this.rootNode),this.scrollNode.addEventListener("scroll",this.handleScroll),setImmediate((function(){t.scrollToBottom()})),this.tryFlushQueue()},t.onStateLoaded=function(){this.loaded=!0,this.tryFlushQueue()},t.tryFlushQueue=function(){this.isReady()&&this.queue.length>0&&(this.processBatch(this.queue),this.queue=[])},t.assignStyle=function(e){void 0===e&&(e={});for(var t=0,n=Object.keys(e);t<n.length;t++){var o=n[t];this.rootNode.style.setProperty(o,e[o])}},t.setHighlight=function(e,t){if(!e||!t)return this.highlightRegex=null,void(this.highlightColor=null);var n=String(e).split(",").map((function(e){return e.trim()})).filter((function(e){return e&&e.length>1}));if(0===n.length)return this.highlightRegex=null,void(this.highlightColor=null);this.highlightRegex=new RegExp("("+n.join("|")+")","g"),this.highlightColor=t},t.scrollToBottom=function(){this.scrollNode.scrollTop=this.scrollNode.scrollHeight},t.changePage=function(e){if(!this.isReady())return this.page=e,void this.tryFlushQueue();this.page=e,this.rootNode.textContent="",this.visibleMessages=[];for(var t,n,o=document.createDocumentFragment(),r=l(this.messages);!(n=r()).done;){var a=n.value;(0,c.canPageAcceptType)(e,a.type)&&(t=a.node,o.appendChild(t),this.visibleMessages.push(a))}t&&(this.rootNode.appendChild(o),t.scrollIntoView())},t.getCombinableMessage=function(e){for(var t=Date.now(),n=this.visibleMessages.length,o=n-1,r=Math.max(0,n-i.COMBINE_MAX_MESSAGES),a=o;a>=r;a--){var s=this.visibleMessages[a];if(!s.type.startsWith(i.MESSAGE_TYPE_INTERNAL)&&(0,c.isSameMessage)(s,e)&&t<s.createdAt+i.COMBINE_MAX_TIME_WINDOW)return s}return null},t.processBatch=function(e,t){var n=this;void 0===t&&(t={});var o=t,r=o.prepend,a=o.notifyListeners,u=void 0===a||a,v=Date.now();if(this.isReady()){for(var S,b,y=document.createDocumentFragment(),C={},E=l(e);!(b=E()).done;){var _=b.value,k=(0,c.createMessage)(_),A=this.getCombinableMessage(k);if(A)A.times=(A.times||1)+1,f(A);else{if(k.node)S=k.node;else if("internal/reconnected"===k.type)S=h();else{S=p(),k.text?S.textContent=k.text:k.html?S.innerHTML=k.html:d.error("Error: message is missing text payload",k),!k.avoidHighlighting&&this.highlightRegex&&(0,s.highlightNode)(S,this.highlightRegex,(function(e){return g(e,n.highlightColor)}))&&(S.className+=" ChatMessage--highlighted");for(var M=S.querySelectorAll(".linkify"),T=0;T<M.length;++T)(0,s.linkifyNode)(M[T]);if(v<k.createdAt+i.IMAGE_RETRY_MESSAGE_AGE)for(var N=S.querySelectorAll("img"),w=0;w<N.length;w++)N[w].addEventListener("error",m)}if(k.node=S,!k.type){var I=!Byond.IS_LTE_IE8&&i.MESSAGE_TYPES.find((function(e){return e.selector&&S.querySelector(e.selector)}));k.type=(null==I?void 0:I.type)||i.MESSAGE_TYPE_UNKNOWN}f(k),C[k.type]||(C[k.type]=0),C[k.type]+=1,this.messages.push(k),(0,c.canPageAcceptType)(this.page,k.type)&&(y.appendChild(S),this.visibleMessages.push(k))}}if(S){var P=this.rootNode.childNodes[0];r&&P?this.rootNode.insertBefore(y,P):this.rootNode.appendChild(y),this.scrollTracking&&setImmediate((function(){return n.scrollToBottom()}))}u&&this.events.emit("batchProcessed",C)}else this.queue=r?[].concat(e,this.queue):[].concat(this.queue,e)},t.pruneMessages=function(){if(this.isReady())if(this.scrollTracking){var e=this.visibleMessages,t=Math.max(0,e.length-i.MAX_VISIBLE_MESSAGES);if(t>0){this.visibleMessages=e.slice(t);for(var n=0;n<t;n++){var o=e[n];this.rootNode.removeChild(o.node),o.node="pruned"}this.messages=this.messages.filter((function(e){return"pruned"!==e.node})),d.log("pruned "+t+" visible messages")}var r=Math.max(0,this.messages.length-i.MAX_PERSISTED_MESSAGES);r>0&&(this.messages=this.messages.slice(r),d.log("pruned "+r+" stored messages"))}else d.debug("pruning delayed")},t.rebuildChat=function(){if(this.isReady()){for(var e,t=Math.max(0,this.messages.length-i.MAX_PERSISTED_MESSAGES),n=this.messages.slice(t),o=l(n);!(e=o()).done;)e.value.node=undefined;this.rootNode.textContent="",this.messages=[],this.visibleMessages=[],this.processBatch(n,{notifyListeners:!1})}},t.saveToDisk=function(){if(!Byond.IS_LTE_IE10){for(var e="",t=document.styleSheets,n=0;n<t.length;n++)for(var o=t[n].rules,r=0;r<o.length;r++)e+=o[r].cssText+"\n";e+="body, html { background-color: #141414 }\n";for(var a,i="",c=l(this.visibleMessages);!(a=c()).done;){var s=a.value;s.node&&(i+=s.node.outerHTML+"\n")}var u=new Blob(['<!doctype html>\n<html>\n<head>\n<meta charset="utf-8">\n<title>SS13 Chat Log</title>\n<style>\n'+e+'</style>\n</head>\n<body>\n<div class="Chat">\n'+i+"</div>\n</body>\n</html>\n"]),d=(new Date).toISOString().substring(0,19).replace(/[-:]/g,"").replace("T","-");window.navigator.msSaveBlob(u,"ss13-chatlog-"+d+".html")}},e}();window.__chatRenderer__||(window.__chatRenderer__=new v);var S=window.__chatRenderer__;t.chatRenderer=S},95879:function(e,t){"use strict";t.__esModule=!0,t.replaceInTextNode=t.linkifyNode=t.highlightNode=void 0;var n=function(e,t){return function(n){for(var o,r,a=n.textContent,i=a.length,c=0,s=0;o=e.exec(a);){s+=1,r||(r=document.createDocumentFragment());var l=o[0],u=l.length,d=o.index;c<d&&r.appendChild(document.createTextNode(a.substring(c,d))),c=d+u,r.appendChild(t(l))}return r&&(c<i&&r.appendChild(document.createTextNode(a.substring(c,i))),n.parentNode.replaceChild(r,n)),s}};t.replaceInTextNode=n;var o=function(e){var t=document.createElement("span");return t.setAttribute("style","background-color:#fd4;color:#000"),t.textContent=e,t};t.highlightNode=function a(e,t,r){void 0===r&&(r=o),r||(r=o);for(var i=0,c=e.childNodes,s=0;s<c.length;s++){var l=c[s];3===l.nodeType?i+=n(t,r)(l):i+=a(l,t,r)}return i};t.linkifyNode=function i(e){for(var t=0,n=e.childNodes,o=0;o<n.length;o++){var a=n[o],c=String(a.nodeName).toLowerCase();3===a.nodeType?t+=r(a):"a"!==c&&(t+=i(a))}return t};var r=n(/(?:(?:https?:\/\/)|(?:www\.))(?:[^ ]*?\.[^ ]*?)+[-A-Za-z0-9+&@#/%?=~_|$!:,.;()]+/gi,(function(e){var t=document.createElement("a");return t.href=e,t.textContent=e,t}))},83790:function(e,t,n){"use strict";t.__esModule=!0,t.selectCurrentChatPage=t.selectChatPages=t.selectChatPageById=t.selectChat=void 0;var o=n(95957);t.selectChat=function(e){return e.chat};t.selectChatPages=function(e){return(0,o.map)((function(t){return e.chat.pageById[t]}))(e.chat.pages)};t.selectCurrentChatPage=function(e){return e.chat.pageById[e.chat.currentPageId]};t.selectChatPageById=function(e){return function(t){return t.chat.pageById[e]}}},51610:function(e,t,n){"use strict";t.__esModule=!0,t.roundRestarted=t.connectionRestored=t.connectionLost=void 0;var o=n(53703),r=(0,o.createAction)("roundrestart");t.roundRestarted=r;var a=(0,o.createAction)("game/connectionLost");t.connectionLost=a;var i=(0,o.createAction)("game/connectionRestored");t.connectionRestored=i},30512:function(e,t,n){"use strict";t.__esModule=!0,t.useGame=void 0;var o=n(53703),r=n(41092);t.useGame=function(e){return(0,o.useSelector)(e,r.selectGame)}},81097:function(e,t,n){"use strict";t.__esModule=!0,t.useGame=t.gameReducer=t.gameMiddleware=void 0;var o=n(30512);t.useGame=o.useGame;var r=n(98369);t.gameMiddleware=r.gameMiddleware;var a=n(6158);t.gameReducer=a.gameReducer},98369:function(e,t,n){"use strict";t.__esModule=!0,t.gameMiddleware=void 0;var o=n(51610);t.gameMiddleware=function(e){return function(e){return function(t){return t.type===o.roundRestarted.type?e(function(e){return Object.assign({},e,{meta:Object.assign({},e.meta,{now:Date.now()})})}(t)):e(t)}}}},6158:function(e,t,n){"use strict";t.__esModule=!0,t.gameReducer=void 0;var o=n(51610),r={roundId:null,roundTime:null,roundRestartedAt:null,connectionLostAt:null};t.gameReducer=function(e,t){void 0===e&&(e=r);var n=t.type,a=t.meta;return"roundrestart"===n?Object.assign({},e,{roundRestartedAt:a.now}):n===o.connectionLost.type?Object.assign({},e,{connectionLostAt:a.now}):n===o.connectionRestored.type?Object.assign({},e,{connectionLostAt:null}):e}},41092:function(e,t){"use strict";t.__esModule=!0,t.selectGame=void 0;t.selectGame=function(e){return e.game}},20475:function(e,t,n){"use strict";var o=n(53658);n(13820),n(67557);var r,a,i=n(20073),c=n(53703),s=(n(37615),n(66363)),l=n(62148),u=n(64074),d=n(67875),g=n(58315),p=n(34448),h=n(81097),m=n(47288),f=n(13459),v=n(61147),S=n(42131),b=n(14486);i.perf.mark("inception",null==(r=window.performance)||null==(a=r.timing)?void 0:a.navigationStart),i.perf.mark("init");var y=(0,d.configureStore)({reducer:(0,c.combineReducers)({audio:g.audioReducer,chat:p.chatReducer,game:h.gameReducer,settings:f.settingsReducer,spellChecker:S.spellCheckerReducer}),middleware:{pre:[p.chatMiddleware,v.telemetryMiddleware,f.settingsMiddleware,g.audioMiddleware,h.gameMiddleware,b.spellCheckerMiddleware]}}),C=(0,u.createRenderer)((function(){var e=n(20978).Panel;return(0,o.createComponentVNode)(2,d.StoreProvider,{store:y,children:(0,o.createComponentVNode)(2,e)})}));!function E(){if("loading"!==document.readyState){for((0,s.setupGlobalEvents)({ignoreWindowFocus:!0}),(0,m.setupPanelFocusHacks)(),(0,l.captureExternalLinks)(),y.subscribe(C),window.update=function(e){return y.dispatch(Byond.parseJson(e))};;){var e=window.__updateQueue__.shift();if(!e)break;window.update(e)}Byond.winset("output",{"is-visible":!1}),Byond.winset("browseroutput",{"is-visible":!0,"is-disabled":!1,pos:"0x0",size:"0x0"}),Byond.winget("output").then((function(e){Byond.winset("browseroutput",{size:e.size})}))}else document.addEventListener("DOMContentLoaded",E)}()},47288:function(e,t,n){"use strict";t.__esModule=!0,t.setupPanelFocusHacks=void 0;var o=n(36556),r=n(66363),a=n(84404),i=function(){return setImmediate((function(){return(0,a.focusMap)()}))};t.setupPanelFocusHacks=function(){var e=!1,t=null;window.addEventListener("focusin",(function(t){e=(0,r.canStealFocus)(t.target)})),window.addEventListener("mousedown",(function(e){t=[e.screenX,e.screenY]})),window.addEventListener("mouseup",(function(n){if(t){var r=[n.screenX,n.screenY];(0,o.vecLength)((0,o.vecSubtract)(r,t))>=10&&(e=!0)}e||i()})),r.globalEvents.on("keydown",(function(e){e.isModifierKey()||i()}))}},98683:function(e,t,n){"use strict";t.__esModule=!0,t.SettingsPanel=t.SettingsGeneral=t.BackgroundImageSettings=void 0;var o=n(53658),r=n(18098),a=n(7994),i=n(53703),c=n(17760),s=n(34448),l=n(49474),u=n(92968),d=n(66068),g=n(40967),p=n(80355);t.SettingsPanel=function(e,t){var n=(0,i.useSelector)(t,p.selectActiveTab),r=(0,i.useDispatch)(t);return(0,o.createComponentVNode)(2,c.Stack,{fill:!0,children:[(0,o.createComponentVNode)(2,c.Stack.Item,{children:(0,o.createComponentVNode)(2,c.Section,{fitted:!0,fill:!0,minHeight:"8em",children:(0,o.createComponentVNode)(2,c.Tabs,{vertical:!0,children:g.SETTINGS_TABS.map((function(e){return(0,o.createComponentVNode)(2,c.Tabs.Tab,{selected:e.id===n,onClick:function(){return r((0,d.changeSettingsTab)({tabId:e.id}))},children:e.name},e.id)}))})})}),(0,o.createComponentVNode)(2,c.Stack.Item,{grow:1,basis:0,children:["general"===n&&(0,o.createComponentVNode)(2,h),"chatPage"===n&&(0,o.createComponentVNode)(2,s.ChatPageSettings),"backgroundImage"===n&&(0,o.createComponentVNode)(2,m)]})]})};var h=function(e,t){var n=(0,i.useSelector)(t,p.selectSettings),s=n.theme,h=n.fontFamily,m=n.fontSize,f=n.lineHeight,v=n.highlightText,S=n.highlightColor,b=(0,i.useDispatch)(t),y=(0,a.useLocalState)(t,"freeFont",!1),C=y[0],E=y[1],_=(0,a.useLocalState)(t,"pastedJson",""),k=_[0],A=_[1];return(0,o.createComponentVNode)(2,c.Section,{children:[(0,o.createComponentVNode)(2,c.LabeledList,{children:[(0,o.createComponentVNode)(2,c.LabeledList.Item,{label:"Theme",children:(0,o.createComponentVNode)(2,c.Dropdown,{selected:s,options:u.THEMES,onSelected:function(e){return b((0,d.updateSettings)({theme:e}))}})}),(0,o.createComponentVNode)(2,c.LabeledList.Item,{label:"Font style",children:(0,o.createComponentVNode)(2,c.Stack,{inline:!0,align:"baseline",children:[(0,o.createComponentVNode)(2,c.Stack.Item,{children:!C&&(0,o.createComponentVNode)(2,c.Dropdown,{selected:h,options:g.FONTS,onSelected:function(e){return b((0,d.updateSettings)({fontFamily:e}))}})||(0,o.createComponentVNode)(2,c.Input,{value:h,onChange:function(e,t){return b((0,d.updateSettings)({fontFamily:t}))}})}),(0,o.createComponentVNode)(2,c.Stack.Item,{children:(0,o.createComponentVNode)(2,c.Button,{content:"Custom font",icon:C?"lock-open":"lock",color:C?"good":"bad",ml:1,onClick:function(){E(!C)}})})]})}),(0,o.createComponentVNode)(2,c.LabeledList.Item,{label:"Font size",children:(0,o.createComponentVNode)(2,c.NumberInput,{width:"4em",step:1,stepPixelSize:10,minValue:8,maxValue:32,value:m,unit:"px",format:function(e){return(0,r.toFixed)(e)},onChange:function(e,t){return b((0,d.updateSettings)({fontSize:t}))}})}),(0,o.createComponentVNode)(2,c.LabeledList.Item,{label:"Line height",children:(0,o.createComponentVNode)(2,c.NumberInput,{width:"4em",step:.01,stepPixelSize:2,minValue:.8,maxValue:5,value:f,format:function(e){return(0,r.toFixed)(e,2)},onDrag:function(e,t){return b((0,d.updateSettings)({lineHeight:t}))}})}),(0,o.createComponentVNode)(2,c.LabeledList.Item,{label:"Save Settings",children:(0,o.createComponentVNode)(2,c.Button,{icon:"download",onClick:function(){return b((0,l.saveSettingsToDisk)())}})}),(0,o.createComponentVNode)(2,c.LabeledList.Item,{label:"Load Settings",children:(0,o.createComponentVNode)(2,c.Stack,{align:"baseline",children:[(0,o.createComponentVNode)(2,c.Stack.Item,{grow:!0,children:(0,o.createComponentVNode)(2,c.Input,{onInput:function(e,t){return A(t)},fluid:!0,placeholder:"Paste your JSON here"})}),(0,o.createComponentVNode)(2,c.Stack.Item,{children:(0,o.createComponentVNode)(2,c.Button,{onClick:function(){return b((0,l.loadSettingsFromDisk)({data:k}))},icon:"upload",content:"Load"})})]})})]}),(0,o.createComponentVNode)(2,c.Divider),(0,o.createComponentVNode)(2,c.Box,{children:[(0,o.createComponentVNode)(2,c.Flex,{mb:1,color:"label",align:"baseline",children:[(0,o.createComponentVNode)(2,c.Flex.Item,{grow:1,children:"Highlight words (comma separated):"}),(0,o.createComponentVNode)(2,c.Flex.Item,{shrink:0,children:[(0,o.createComponentVNode)(2,c.ColorBox,{mr:1,color:S}),(0,o.createComponentVNode)(2,c.Input,{width:"5em",monospace:!0,placeholder:"#ffffff",value:S,onInput:function(e,t){return b((0,d.updateSettings)({highlightColor:t}))}})]})]}),(0,o.createComponentVNode)(2,c.TextArea,{height:"3em",value:v,onChange:function(e,t){return b((0,d.updateSettings)({highlightText:t}))}})]}),(0,o.createComponentVNode)(2,c.Divider),(0,o.createComponentVNode)(2,c.Box,{children:[(0,o.createComponentVNode)(2,c.Button,{icon:"check",onClick:function(){return b((0,l.rebuildChat)())},children:"Apply now"}),(0,o.createComponentVNode)(2,c.Box,{inline:!0,fontSize:"0.9em",ml:1,color:"label",children:"Can freeze the chat for a while."})]}),(0,o.createComponentVNode)(2,c.Divider),(0,o.createComponentVNode)(2,c.Button,{icon:"save",onClick:function(){return b((0,l.saveChatToDisk)())},children:"Save chat log"}),(0,o.createComponentVNode)(2,c.Button.Confirm,{icon:"trash",color:"red",onClick:function(){return b((0,l.resetSettings)())},children:"Reset Chat"})]})};t.SettingsGeneral=h;var m=function(e,t){var n=(0,i.useSelector)(t,p.selectSettings).background,r=(0,i.useDispatch)(t);n||(n={url:null,opaque:0,repeat:g.REPEAT_MODE.no,size:g.SIZE_MODE.contain});var a=n,s=a.url,l=a.opaque,u=a.repeat,h=a.size;return(0,o.createComponentVNode)(2,c.Section,{children:(0,o.createComponentVNode)(2,c.LabeledList,{children:[(0,o.createComponentVNode)(2,c.LabeledList.Item,{label:"Image",children:(0,o.createComponentVNode)(2,c.Input,{fluid:!0,placeholder:"Paste URL",value:s,onChange:function(e,t){return r((0,d.updateSettings)({background:Object.assign({},n,{url:t})}))}})}),(0,o.createComponentVNode)(2,c.LabeledList.Item,{label:"Opaque",children:(0,o.createComponentVNode)(2,c.NumberInput,{minValue:0,maxValue:100,value:l,unit:"%",onChange:function(e,t){return r((0,d.updateSettings)({background:Object.assign({},n,{opaque:t})}))}})}),(0,o.createComponentVNode)(2,c.LabeledList.Item,{label:"Repeat",children:[(0,o.createComponentVNode)(2,c.Button.Checkbox,{content:"No Repeat",checked:u===g.REPEAT_MODE.no,onClick:function(){return r((0,d.updateSettings)({background:Object.assign({},n,{repeat:g.REPEAT_MODE.no})}))}}),(0,o.createComponentVNode)(2,c.Button.Checkbox,{content:"Repeat",checked:u===g.REPEAT_MODE.repeat,onClick:function(){return r((0,d.updateSettings)({background:Object.assign({},n,{repeat:g.REPEAT_MODE.repeat})}))}}),(0,o.createComponentVNode)(2,c.Button.Checkbox,{content:"Repeat-X",checked:u===g.REPEAT_MODE.repeatx,onClick:function(){return r((0,d.updateSettings)({background:Object.assign({},n,{repeat:g.REPEAT_MODE.repeatx})}))}}),(0,o.createComponentVNode)(2,c.Button.Checkbox,{content:"Repeat-Y",checked:u===g.REPEAT_MODE.repeaty,onClick:function(){return r((0,d.updateSettings)({background:Object.assign({},n,{repeat:g.REPEAT_MODE.repeaty})}))}})]}),(0,o.createComponentVNode)(2,c.LabeledList.Item,{label:"Size",children:[(0,o.createComponentVNode)(2,c.Button.Checkbox,{content:"Cover",checked:h===g.SIZE_MODE.cover,onClick:function(){return r((0,d.updateSettings)({background:Object.assign({},n,{size:g.SIZE_MODE.cover})}))}}),(0,o.createComponentVNode)(2,c.Button.Checkbox,{content:"Contain",checked:h===g.SIZE_MODE.contain,onClick:function(){return r((0,d.updateSettings)({background:Object.assign({},n,{size:g.SIZE_MODE.contain})}))}})]})]})})};t.BackgroundImageSettings=m},66068:function(e,t,n){"use strict";t.__esModule=!0,t.updateSettings=t.toggleSettings=t.openChatSettings=t.loadSettings=t.changeSettingsTab=void 0;var o=n(53703),r=(0,o.createAction)("settings/update");t.updateSettings=r;var a=(0,o.createAction)("settings/load");t.loadSettings=a;var i=(0,o.createAction)("settings/changeTab");t.changeSettingsTab=i;var c=(0,o.createAction)("settings/toggle");t.toggleSettings=c;var s=(0,o.createAction)("settings/openChatTab");t.openChatSettings=s},40967:function(e,t){"use strict";t.__esModule=!0,t.SIZE_MODE=t.SETTINGS_TABS=t.REPEAT_MODE=t.FONTS_DISABLED=t.FONTS=void 0;t.SETTINGS_TABS=[{id:"general",name:"General"},{id:"chatPage",name:"Chat Tabs"},{id:"backgroundImage",name:"Background Image"}];var n="Default";t.FONTS_DISABLED=n;var o=[n,"Verdana","Arial","Arial Black","Comic Sans MS","Impact","Lucida Sans Unicode","Tahoma","Trebuchet MS","Courier New","Lucida Console"];t.FONTS=o;t.REPEAT_MODE={no:"no-repeat",repeat:"repeat",repeatx:"repeat-x",repeaty:"repeat-y"};t.SIZE_MODE={cover:"cover",contain:"contain"}},31739:function(e,t,n){"use strict";t.__esModule=!0,t.useSettings=void 0;var o=n(53703),r=n(66068),a=n(80355);t.useSettings=function(e){var t=(0,o.useSelector)(e,a.selectSettings),n=(0,o.useDispatch)(e);return Object.assign({},t,{visible:t.view.visible,toggle:function(){return n((0,r.toggleSettings)())},update:function(e){return n((0,r.updateSettings)(e))}})}},13459:function(e,t,n){"use strict";t.__esModule=!0,t.useSettings=t.settingsReducer=t.settingsMiddleware=t.SettingsPanel=void 0;var o=n(31739);t.useSettings=o.useSettings;var r=n(12038);t.settingsMiddleware=r.settingsMiddleware;var a=n(5167);t.settingsReducer=a.settingsReducer;var i=n(98683);t.SettingsPanel=i.SettingsPanel},12038:function(e,t,n){"use strict";t.__esModule=!0,t.settingsMiddleware=void 0;var o=n(86175),r=n(92968),a=n(66068),i=n(80355),c=n(40967),s=n(49474);t.settingsMiddleware=function(e){var t=!1;return function(n){return function(l){var u,d,g,p,h,m,f,v,S,b,y,C,E,_=l.type,k=l.payload;if(t||(t=!0,o.storage.get("panel-settings").then((function(t){e.dispatch((0,a.loadSettings)(t))}))),_===a.updateSettings.type||_===a.loadSettings.type){var A=null==k?void 0:k.theme;A&&(0,r.setClientTheme)(A),n(l);var M=(0,i.selectSettings)(e.getState());return y=M.fontSize,null==(C=document.documentElement)||C.style.setProperty("font-size",y+"px"),null==(E=document.body)||E.style.setProperty("font-size",y+"px"),(v=M.fontFamily)===c.FONTS_DISABLED&&(v=null),null==(S=document.documentElement)||S.style.setProperty("font-family",v+', "apple color emoji", "segoe ui emoji", "segoe ui symbol"'),null==(b=document.body)||b.style.setProperty("font-family",v+', "apple color emoji", "segoe ui emoji", "segoe ui symbol"'),u=M.background,d=u.url,g=u.opaque,p=u.repeat,h=u.size,m=document.querySelectorAll("#chatContainer")[0],f=document.querySelectorAll("#imageContainer")[0],m&&f&&(d?(m.style.setProperty("background-color","rgba(0, 0, 0, 0.0)"),f.style.setProperty("background-image",'url("'+encodeURI(d)+'")'),f.style.setProperty("opacity",g/100),f.style.setProperty("background-repeat",p),f.style.setProperty("background-size",h)):(m.style.removeProperty("background-color"),f.style.removeProperty("background-image"))),void o.storage.set("panel-settings",M)}return _===s.resetSettings.type&&(o.storage.clear(),Byond.winset({command:"Nuke-Chat"})),n(l)}}}},5167:function(e,t,n){"use strict";t.__esModule=!0,t.settingsReducer=void 0;var o=n(66068),r=n(40967),a={version:1,fontSize:13,fontFamily:r.FONTS[0],lineHeight:1.2,iconSize:16,theme:"light",adminMusicVolume:.5,highlightText:"",highlightColor:"#ffdd44",view:{visible:!1,activeTab:r.SETTINGS_TABS[0].id},background:{url:null,opaque:0,repeat:r.REPEAT_MODE.no,size:r.SIZE_MODE.contain}};t.settingsReducer=function(e,t){void 0===e&&(e=a);var n=t.type,r=t.payload;if(n===o.updateSettings.type)return Object.assign({},e,r);if(n===o.loadSettings.type)return null!=r&&r.version?(delete r.view,Object.assign({},e,r)):e;if(n===o.toggleSettings.type)return Object.assign({},e,{view:Object.assign({},e.view,{visible:!e.view.visible})});if(n===o.openChatSettings.type)return Object.assign({},e,{view:Object.assign({},e.view,{visible:!0,activeTab:"chatPage"})});if(n===o.changeSettingsTab.type){var i=r.tabId;return Object.assign({},e,{view:Object.assign({},e.view,{activeTab:i})})}return e}},80355:function(e,t){"use strict";t.__esModule=!0,t.selectSettings=t.selectActiveTab=void 0;t.selectSettings=function(e){return e.settings};t.selectActiveTab=function(e){return e.settings.view.activeTab}},64608:function(e,t,n){"use strict";t.__esModule=!0,t.SpellCheckerSettings=void 0;var o=n(53658),r=n(53703),a=n(17760),i=n(69113),c=n(42131),s=n(20147);t.SpellCheckerSettings=function(e,t){var n=(0,r.useSelector)(t,s.selectSpellChecker),l=n.enabled,u=n.blacklist,d=(0,r.useDispatch)(t);return(0,o.createComponentVNode)(2,a.Section,{children:[(0,o.createComponentVNode)(2,a.LabeledList,{children:[(0,o.createComponentVNode)(2,a.LabeledList.Item,{label:"Enable",children:(0,o.createComponentVNode)(2,a.Button.Checkbox,{checked:l,tooltip:"Enables spell checking of an input text.",tooltipPosition:"right",onClick:function(){return d((0,i.updateSpellCheckerSettings)({enabled:!l}))}})}),(0,o.createComponentVNode)(2,a.LabeledList.Item,{label:"Restore Blacklist",children:(0,o.createComponentVNode)(2,a.Button.Confirm,{icon:"trash",tooltip:"Restores the blacklist to default words.",tooltipPosition:"right",onClick:function(){return d((0,i.updateSpellCheckerSettings)({blacklist:c.defaultBlacklist}))}})})]}),(0,o.createComponentVNode)(2,a.Divider),(0,o.createComponentVNode)(2,a.Box,{direction:"column",mb:1,color:"label",align:"baseline",children:["Blacklist (comma separated):",(0,o.createComponentVNode)(2,a.TextArea,{height:"6em",value:u,onChange:function(e,t){return d((0,i.updateSpellCheckerSettings)({blacklist:t}))}})]})]})}},69113:function(e,t,n){"use strict";t.__esModule=!0,t.updateSpellCheckerSettings=t.toggleSpellChecker=t.loadSpellCheckerSettings=t.doSpellCheck=void 0;var o=n(53703),r=(0,o.createAction)("spellCheckerSettings/load");t.loadSpellCheckerSettings=r;var a=(0,o.createAction)("spellCheckerSettings/update");t.updateSpellCheckerSettings=a;var i=(0,o.createAction)("spellChecker/toggle");t.toggleSpellChecker=i;var c=(0,o.createAction)("chat/spellcheck");t.doSpellCheck=c},82670:function(e,t){"use strict";t.__esModule=!0,t.YANDEX_BASE_URI=void 0;t.YANDEX_BASE_URI="http://speller.yandex.net/services/spellservice.json/checkText?options=512&text="},19560:function(e,t,n){"use strict";t.__esModule=!0,t.useSpellCheckerSettings=void 0;var o=n(53703),r=n(69113),a=n(20147);t.useSpellCheckerSettings=function(e){var t=(0,o.useSelector)(e,a.selectSpellChecker),n=(0,o.useDispatch)(e);return Object.assign({},t,{visible:t.visible,toggle:function(){return n((0,r.toggleSpellChecker)())},update:function(e){return n((0,r.updateSpellCheckerSettings)(e))}})}},93779:function(e,t,n){"use strict";t.__esModule=!0,t.useSpellCheckerSettings=t.spellCheckerReducer=t.resetSpellCheckerBlacklist=t.SpellCheckerSettings=void 0;var o=n(19560);t.useSpellCheckerSettings=o.useSpellCheckerSettings;var r=n(42131);t.spellCheckerReducer=r.spellCheckerReducer;var a=n(64608);t.SpellCheckerSettings=a.SpellCheckerSettings;var i=n(69113);t.resetSpellCheckerBlacklist=i.resetSpellCheckerBlacklist},14486:function(e,t,n){"use strict";t.__esModule=!0,t.spellCheckerMiddleware=void 0;var o=n(86175),r=n(51515),a=n(69113),i=n(82670),c=n(20147);function s(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0;return function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}var u=function(e){for(var t,n=[],o=s(e);!(t=o()).done;){var r=t.value;n=n.concat("<span class='correct-word'>"+r.correct+"</span> - <span class='error-word'>"+r.mistake+"</span>")}return"<span class=\"fas fa-spell-check\"></span> <span class='spell-error'>\u0412\u043e\u0437\u043c\u043e\u0436\u043d\u044b\u0435 \u043e\u0440\u0444\u043e\u0433\u0440\u0430\u0444\u0438\u0447\u0435\u0441\u043a\u0438\u0435 \u043e\u0448\u0438\u0431\u043a\u0438: "+n.join("")+"</span>"};t.spellCheckerMiddleware=function(e){var t=!1;return function(n){return function(l){var d=l.type,g=l.payload;t||(t=!0,o.storage.get("spellchecker-settings").then((function(t){e.dispatch((0,a.loadSpellCheckerSettings)(t))}))),n(l);var p=(0,c.selectSpellChecker)(e.getState());if(d===a.doSpellCheck.type&&p.enabled){var h=g.toLowerCase().replace(/[^\u0430-\u044f\u0410-\u042f\u0451\u0401 ]/g," ").replace(/\s+/g," ");h=function(e,t){var n=t.split(",")||t,o=e;if(!t)return o;for(var r,a=s(n);!(r=a()).done;){var i="(?:\\s|^)(?:"+r.value.trim()+")\\S*";o=o.replace(new RegExp(i,"g"),"")}return o}(h,p.blacklist),function(e,t){var n=new XMLHttpRequest;n.onreadystatechange=function(){return t(n)},n.open("GET",""+i.YANDEX_BASE_URI+encodeURIComponent(e),!0),n.send()}(h,(function(t){if(t.readyState===XMLHttpRequest.DONE&&200===t.status){var n=function(e){return e.filter((function(e){return e.s.length>0})).map((function(e){return{mistake:e.word,correct:e.s.join(",")}}))}(JSON.parse(t.responseText));if(0===n.length)return;e.dispatch({type:"chat/message",payload:{type:r.MESSAGE_TYPE_INTERNAL,html:u(n)}})}}))}d===a.updateSpellCheckerSettings.type&&o.storage.set("spellchecker-settings",p)}}}},42131:function(e,t,n){"use strict";t.__esModule=!0,t.spellCheckerReducer=t.defaultBlacklist=void 0;var o=n(69113),r={enabled:!1,visible:!1,blacklist:"\u0431\u0438\u043f\u0441\u043a\u0438, \u0434\u043e\u0440\u043c, \u0435\u0433\u0430\u043d, \u0435\u043c\u0430\u0433, \u0438\u043e\u043d\u043a, \u043d\u0430\u0443\u0447\u043a, \u0441\u0438\u043d\u0433, \u0441\u043a\u0440\u0430\u0431\u0435\u0440, \u0442\u0435\u0440\u043c\u0430\u043b\u044b, \u0445\u043e\u043d\u043a, \u0446\u0435\u043d\u0442\u043a\u043e\u043c, \u0433\u043e\u043b\u043e\u0434\u0435\u043a, \u0442\u0430\u0437\u0435\u0440, \u043a\u0441\u0435\u043d, \u043c\u0443\u0441\u043e\u0440\u043a"},a=r.blacklist;t.defaultBlacklist=a;t.spellCheckerReducer=function(e,t){void 0===e&&(e=r);var n=t.type,a=t.payload;return n===o.loadSpellCheckerSettings.type?a?(a.visible=!1,Object.assign({},e,a)):Object.assign({},r):n===o.updateSpellCheckerSettings.type?Object.assign({},e,a):n===o.toggleSpellChecker.type?Object.assign({},e,{visible:!e.visible}):e}},20147:function(e,t){"use strict";t.__esModule=!0,t.selectSpellChecker=void 0;t.selectSpellChecker=function(e){return e.spellChecker}},61147:function(e,t,n){"use strict";t.__esModule=!0,t.telemetryMiddleware=void 0;var o=n(7994),r=n(86175);function a(e,t,n,o,r,a,i){try{var c=e[a](i),s=c.value}catch(l){return void n(l)}c.done?t(s):Promise.resolve(s).then(o,r)}var i=(0,n(52974).createLogger)("telemetry");t.telemetryMiddleware=function(e){var t,n;return function(c){return function(s){var l,u=s.type,d=s.payload;if("telemetry/request"!==u)return"backend/update"===u?(c(s),void(l=regeneratorRuntime.mark((function h(){var o,a,c,s;return regeneratorRuntime.wrap((function(l){for(;;)switch(l.prev=l.next){case 0:if(a=null==d||null==(o=d.config)?void 0:o.client){l.next=4;break}return i.error("backend/update payload is missing client data!"),l.abrupt("return");case 4:if(t){l.next=13;break}return l.next=7,r.storage.get("telemetry");case 7:if(l.t0=l.sent,l.t0){l.next=10;break}l.t0={};case 10:(t=l.t0).connections||(t.connections=[]),i.debug("retrieved telemetry from storage",t);case 13:c=!1,t.connections.find((function(e){return n=a,(t=e).ckey===n.ckey&&t.address===n.address&&t.computer_id===n.computer_id;var t,n}))||(c=!0,t.connections.unshift(a),t.connections.length>10&&t.connections.pop()),c&&(i.debug("saving telemetry to storage",t),r.storage.set("telemetry",t)),n&&(s=n,n=null,e.dispatch({type:"telemetry/request",payload:s}));case 18:case"end":return l.stop()}}),h)})),function(){var e=this,t=arguments;return new Promise((function(n,o){var r=l.apply(e,t);function i(e){a(r,n,o,i,c,"next",e)}function c(e){a(r,n,o,i,c,"throw",e)}i(undefined)}))})()):c(s);if(!t)return i.debug("deferred"),void(n=d);i.debug("sending");var g=(null==d?void 0:d.limits)||{},p=t.connections.slice(0,g.connections);(0,o.sendMessage)({type:"telemetry",payload:{connections:p}})}}}},92968:function(e,t){"use strict";t.__esModule=!0,t.setClientTheme=t.THEMES=void 0;t.THEMES=["light","dark"];var n="#202020",o="#171717",r="#a4bad6",a=null;t.setClientTheme=function(e){if(clearInterval(a),Byond.command(".output statbrowser:set_theme "+e),a=setTimeout((function(){Byond.command(".output statbrowser:set_theme "+e)}),1500),"light"===e)return Byond.winset({"infowindow.background-color":"none","infowindow.text-color":"#000000","info.background-color":"none","info.text-color":"#000000","browseroutput.background-color":"none","browseroutput.text-color":"#000000","outputwindow.background-color":"none","outputwindow.text-color":"#000000","mainwindow.background-color":"none","mainvsplit.background-color":"none","changelog.background-color":"none","changelog.text-color":"#000000","rulesb.background-color":"none","rulesb.text-color":"#000000","wikib.background-color":"none","wikib.text-color":"#000000","discordb.background-color":"none","discordb.text-color":"#000000","backstoryb.background-color":"none","backstoryb.text-color":"#000000","bugreportb.background-color":"none","bugreportb.text-color":"#000000","storeb.background-color":"none","storeb.text-color":"#000000","output.background-color":"none","output.text-color":"#000000","statwindow.background-color":"none","statwindow.text-color":"#000000","stat.background-color":"#FFFFFF","stat.tab-background-color":"none","stat.text-color":"#000000","stat.tab-text-color":"#000000","stat.prefix-color":"#000000","stat.suffix-color":"#000000","asset_cache_browser.background-color":"none","asset_cache_browser.text-color":"#000000","saybutton.background-color":"none","saybutton.text-color":"#000000","hotkey_toggle.background-color":"none","hotkey_toggle.text-color":"#000000","input.background-color":"none","input.text-color":"#000000","saybutton_alt.background-color":"none","saybutton_alt.text-color":"#000000","hotkey_toggle_alt.background-color":"none","hotkey_toggle_alt.text-color":"#000000","input_alt.background-color":"none","input_alt.text-color":"#000000"});"dark"===e&&Byond.winset({"infowindow.background-color":n,"infowindow.text-color":r,"info.background-color":n,"info.text-color":r,"browseroutput.background-color":n,"browseroutput.text-color":r,"outputwindow.background-color":n,"outputwindow.text-color":r,"mainwindow.background-color":n,"mainvsplit.background-color":n,"changelog.background-color":"#494949","changelog.text-color":r,"rulesb.background-color":"#494949","rulesb.text-color":r,"wikib.background-color":"#494949","wikib.text-color":r,"discordb.background-color":"#494949","discordb.text-color":r,"backstoryb.background-color":"#494949","backstoryb.text-color":r,"bugreportb.background-color":"#494949","bugreportb.text-color":r,"storeb.background-color":"#494949","storeb.text-color":r,"output.background-color":o,"output.text-color":r,"statwindow.background-color":o,"statwindow.text-color":r,"stat.background-color":o,"stat.tab-background-color":n,"stat.text-color":r,"stat.tab-text-color":r,"stat.prefix-color":r,"stat.suffix-color":r,"asset_cache_browser.background-color":n,"asset_cache_browser.text-color":r,"saybutton.background-color":n,"saybutton.text-color":r,"hotkey_toggle.background-color":n,"hotkey_toggle.text-color":r,"input.background-color":n,"input.text-color":r,"saybutton_alt.background-color":n,"saybutton_alt.text-color":r,"hotkey_toggle_alt.background-color":n,"hotkey_toggle_alt.text-color":r,"input_alt.background-color":n,"input_alt.text-color":r})}},13820:function(){},67557:function(){}},n={};function o(e){var r=n[e];if(r!==undefined)return r.exports;var a=n[e]={exports:{}};return t[e](a,a.exports,o),a.exports}o.m=t,e=[],o.O=function(t,n,r,a){if(!n){var i=Infinity;for(u=0;u<e.length;u++){n=e[u][0],r=e[u][1],a=e[u][2];for(var c=!0,s=0;s<n.length;s++)(!1&a||i>=a)&&Object.keys(o.O).every((function(e){return o.O[e](n[s])}))?n.splice(s--,1):(c=!1,a<i&&(i=a));if(c){e.splice(u--,1);var l=r();l!==undefined&&(t=l)}}return t}a=a||0;for(var u=e.length;u>0&&e[u-1][2]>a;u--)e[u]=e[u-1];e[u]=[n,r,a]},o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e={3:0};o.O.j=function(t){return 0===e[t]};var t=function(t,n){var r,a,i=n[0],c=n[1],s=n[2],l=0;if(i.some((function(t){return 0!==e[t]}))){for(r in c)o.o(c,r)&&(o.m[r]=c[r]);if(s)var u=s(o)}for(t&&t(n);l<i.length;l++)a=i[l],o.o(e,a)&&e[a]&&e[a][0](),e[i[l]]=0;return o.O(u)},n=self.webpackChunktgui_workspace=self.webpackChunktgui_workspace||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}(),o.O(undefined,[962],(function(){return o(20044)}));var r=o.O(undefined,[962],(function(){return o(20475)}));r=o.O(r)}();